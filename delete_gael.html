<!DOCTYPE html>
<html>
<head>
    <title>Supprimer Gael Rakotoharimanga</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 50px; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>Supprimer d√©finitivement Gael Rakotoharimanga</h1>
    
    <div id="status"></div>
    
    <button onclick="checkUser()">1. V√©rifier si Gael existe</button>
    <button onclick="deleteUser()" style="background-color: #ff4444; color: white;">2. SUPPRIMER D√âFINITIVEMENT</button>
    
    <div id="result"></div>

    <script>
        const API_BASE = 'https://sales-tracker-pro-v2.onrender.com/api';
        
        function getToken() {
            return localStorage.getItem('authToken');
        }
        
        async function checkUser() {
            const token = getToken();
            if (!token) {
                document.getElementById('result').innerHTML = '<p class="error">‚ùå Token d\'authentification manquant. Connectez-vous d\'abord sur votre app admin.</p>';
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/accounts/temp/cleanup-gael/`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.exists) {
                    document.getElementById('result').innerHTML = `
                        <div class="info">
                            <h3>‚úÖ Utilisateur trouv√© dans la base de donn√©es:</h3>
                            <pre>${JSON.stringify(data.user, null, 2)}</pre>
                            <p><strong>Cet utilisateur peut maintenant √™tre supprim√© d√©finitivement.</strong></p>
                        </div>
                    `;
                } else {
                    document.getElementById('result').innerHTML = '<p class="success">‚úÖ Utilisateur Gael n\'existe pas dans la base de donn√©es.</p>';
                }
            } catch (error) {
                document.getElementById('result').innerHTML = `<p class="error">‚ùå Erreur: ${error.message}</p>`;
            }
        }
        
        async function deleteUser() {
            if (!confirm('ATTENTION: Cette action va supprimer d√©finitivement Gael Rakotoharimanga de la base de donn√©es. Continuer?')) {
                return;
            }
            
            const token = getToken();
            if (!token) {
                document.getElementById('result').innerHTML = '<p class="error">‚ùå Token d\'authentification manquant. Connectez-vous d\'abord sur votre app admin.</p>';
                return;
            }
            
            try {
                document.getElementById('status').innerHTML = '<p class="info">üîÑ Suppression en cours...</p>';
                
                const response = await fetch(`${API_BASE}/accounts/temp/cleanup-gael/`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('result').innerHTML = `
                        <div class="success">
                            <h3>‚úÖ UTILISATEUR SUPPRIM√â AVEC SUCC√àS!</h3>
                            <p>${data.message}</p>
                            <h4>D√©tails de l'utilisateur supprim√©:</h4>
                            <pre>${JSON.stringify(data.deleted_user, null, 2)}</pre>
                            <p><strong>Actualisez maintenant votre interface admin pour voir les changements.</strong></p>
                        </div>
                    `;
                    document.getElementById('status').innerHTML = '';
                } else {
                    document.getElementById('result').innerHTML = `<p class="error">‚ùå ${data.message}</p>`;
                    document.getElementById('status').innerHTML = '';
                }
            } catch (error) {
                document.getElementById('result').innerHTML = `<p class="error">‚ùå Erreur: ${error.message}</p>`;
                document.getElementById('status').innerHTML = '';
            }
        }
        
        // V√©rifier automatiquement au chargement
        window.onload = function() {
            const token = getToken();
            if (token) {
                document.getElementById('status').innerHTML = '<p class="success">‚úÖ Token d\'authentification trouv√©</p>';
            } else {
                document.getElementById('status').innerHTML = '<p class="error">‚ùå Connectez-vous d\'abord sur votre interface admin pour obtenir un token</p>';
            }
        };
    </script>
</body>
</html>
